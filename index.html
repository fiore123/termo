<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Termo</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --dark-bg: #1a1a1a;
            --main-bg: #2d2d2d;
            --box-border: #444;
            --text-color: #d3d6da;
            --key-bg: #818384;
            --key-text: white;
            --correct: #6aaa64;
            --present: #c9b458;
            --absent: #3a3a3c;
        }
        body {
            font-family: 'Poppins', 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: var(--dark-bg);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        h1 {
            color: white;
            text-shadow: 2px 2px 4px #000;
            font-weight: 600;
        }
        .game-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 550px;
            margin-bottom: 20px;
        }
        .game-stats span {
            font-size: 1.2em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .game-stats button {
            background-color: #555;
            font-size: 1.5em;
            line-height: 1;
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            color: white;
        }
        .options {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        select, button {
            padding: 8px 15px;
            font-size: 1em;
            cursor: pointer;
            border: none;
            border-radius: 5px;
        }
        .start-button {
            background-color: var(--correct);
            color: white;
            font-weight: 600;
        }
        #gameContainer {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        .gameBoard {
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-width: 300px;
            border-radius: 5px;
        }
        .row {
            display: flex;
            gap: 8px;
        }
        .box {
            width: 50px;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2em;
            font-weight: 600;
            text-transform: uppercase;
            border: 2px solid var(--box-border);
            background-color: var(--main-bg);
            color: white;
            cursor: pointer;
            box-sizing: border-box;
            transition: background-color 0.4s ease, transform 0.3s ease, border-color 0.4s ease;
            border-radius: 5px;
        }
        .box.active { border-color: white; }
        .box.correct { animation: flipCorrect 0.6s forwards; }
        .box.present { animation: flipPresent 0.6s forwards; }
        .box.absent { animation: flipAbsent 0.6s forwards; }
        @keyframes flipCorrect {
            0% { transform: rotateX(0deg); }
            50% { transform: rotateX(90deg); background-color: var(--main-bg); }
            100% { transform: rotateX(0deg); background-color: var(--correct); border-color: var(--correct); }
        }
        @keyframes flipPresent {
            0% { transform: rotateX(0deg); }
            50% { transform: rotateX(90deg); background-color: var(--main-bg); }
            100% { transform: rotateX(0deg); background-color: var(--present); border-color: var(--present); }
        }
        @keyframes flipAbsent {
            0% { transform: rotateX(0deg); }
            50% { transform: rotateX(90deg); background-color: var(--main-bg); }
            100% { transform: rotateX(0deg); background-color: var(--absent); border-color: var(--absent); }
        }
        #keyboard {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 550px;
            margin-top: 25px;
            gap: 8px;
        }
        .key-row { display: flex; justify-content: center; gap: 6px; width: 100%; }
        .key {
            position: relative;
            flex-grow: 1;
            height: 50px;
            background-color: var(--key-bg);
            border: none;
            border-radius: 5px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            text-transform: uppercase;
            display: flex;
            justify-content: center;
            align-items: center;
            user-select: none;
            color: var(--key-text);
            transition: background-color 0.2s;
            flex: 1;
        }
        .key.wide-key { flex: 1.5; }
        #tempMessage {
            position: fixed;
            top: 15%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 10px 20px;
            background-color: #333;
            color: white;
            border-radius: 5px;
            font-size: 1.2em;
            font-weight: 600;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            pointer-events: none;
        }
        #message { margin-top: 20px; font-size: 1.2em; font-weight: 600; color: var(--text-color); }
        .modal-overlay, .hint-modal-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content, .hint-modal-content {
            background-color: var(--main-bg);
            color: var(--text-color);
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            max-width: 80%;
            min-width: 300px;
        }
        .modal-content h2, .hint-modal-content h3 { font-weight: 600; }
        .mute-button { position: absolute; top: 20px; right: 20px; background-color: transparent; border: none; cursor: pointer; font-size: 1.5em; color: var(--text-color); padding: 5px; }
        .mute-button:hover { color: white; }
    </style>
</head>
<body>
    <h1>Termo Duzamigos</h1>
    <div class="game-stats">
        <span>üèÜ <span id="victoryCount">0</span></span>
        <span>‚ú® <span id="recordCount">0</span></span>
        <button id="restartButton">&#x21BB;</button>
        <button id="hintButton">üí°</button>
    </div>
    <div class="options">
        <label for="wordCountSelect">Dificuldade:</label>
        <select id="wordCountSelect">
            <option value="1">1 termo</option>
            <option value="2">2 termos</option>
            <option value="3">3 termos</option>
            <option value="4">4 termos</option>
        </select>
        <button id="startButton" class="start-button">Come√ßar</button>
    </div>
    <div id="gameContainer"></div>
    <div id="keyboard"></div>
    <div id="tempMessage"></div>
    <p id="message"></p>
    <div id="endGameModal" class="modal-overlay">
        <div class="modal-content">
            <h2 id="modalStatus"></h2>
            <p id="modalCorrectWords"></p>
            <p>Vit√≥rias na Rodada: <span id="modalVictories"></span></p>
            <p>Seu Recorde: <span id="modalRecord"></span></p>
            <p>Tempo Levado: <span id="modalTime"></span></p>
            <button id="modalNewGameButton" class="start-button">Novo Jogo</button>
        </div>
    </div>
    <div id="hintModal" class="hint-modal-overlay">
        <div class="hint-modal-content">
            <h3>Deseja mesmo uma dica?</h3>
            <p>Uma letra correta ser√° revelada.</p>
            <button id="confirmHintButton" class="start-button">Sim</button>
            <button id="cancelHintButton" class="start-button">N√£o</button>
        </div>
    </div>
    <button class="mute-button" id="muteButton">üîä</button>

    <script>
        const TermoGame = {
            state: { wordDatabase: [], currentWords: [], wordLength: 5, currentRow: 0, maxAttempts: 6, victoryCount: 0, recordCount: 0, normalizedWordDatabase: [], startTime: null, isMuted: false, solvedWords: 0, keyColorStates: {} },
            elements: { gameContainer: document.getElementById('gameContainer'), messageDisplay: document.getElementById('message'), startButton: document.getElementById('startButton'), wordCountSelect: document.getElementById('wordCountSelect'), keyboardContainer: document.getElementById('keyboard'), victoryCountDisplay: document.getElementById('victoryCount'), recordCountDisplay: document.getElementById('recordCount'), restartButton: document.getElementById('restartButton'), tempMessageDisplay: document.getElementById('tempMessage'), endGameModal: document.getElementById('endGameModal'), modalStatus: document.getElementById('modalStatus'), modalVictories: document.getElementById('modalVictories'), modalRecord: document.getElementById('modalRecord'), modalTime: document.getElementById('modalTime'), modalCorrectWords: document.getElementById('modalCorrectWords'), modalNewGameButton: document.getElementById('modalNewGameButton'), muteButton: document.getElementById('muteButton'), hintButton: document.getElementById('hintButton'), hintModal: document.getElementById('hintModal'), confirmHintButton: document.getElementById('confirmHintButton'), cancelHintButton: document.getElementById('cancelHintButton') },
            sounds: { correct: new Audio('correct.mp3'), incorrect: new Audio('incorrect.mp3'), defeat: new Audio('defeat.mp3') },
            init: function() { this.bindEvents(); this.loadGameData(); this.loadWords(); },
            bindEvents: function() { this.elements.startButton.addEventListener('click', this.loadWords.bind(this)); this.elements.restartButton.addEventListener('click', this.startGame.bind(this)); this.elements.modalNewGameButton.addEventListener('click', () => { this.elements.endGameModal.style.display = 'none'; this.startGame(); }); this.elements.muteButton.addEventListener('click', this.toggleMute.bind(this)); this.elements.hintButton.addEventListener('click', this.showHintModal.bind(this)); this.elements.confirmHintButton.addEventListener('click', this.revealHint.bind(this)); this.elements.cancelHintButton.addEventListener('click', () => this.elements.hintModal.style.display = 'none'); document.addEventListener('keydown', this.handleKeyDown.bind(this)); },
            normalizeString: function(str) { return str.normalize("NFD").replace(/[\u0300-\u036f]/g, ""); },
            playSound: function(sound) { if(!this.state.isMuted) sound.play(); },
            showTemporaryMessage: function(msg) { this.elements.tempMessageDisplay.textContent = msg; this.elements.tempMessageDisplay.style.opacity='1'; setTimeout(()=>{this.elements.tempMessageDisplay.style.opacity='0';},2000); },
            loadWords: async function() { try { this.elements.messageDisplay.textContent='Carregando palavras...'; const response = await fetch('palavras.json'); if(!response.ok) throw new Error('Erro ao carregar o arquivo de palavras.'); const data = await response.json(); const filtered = data.filter(word=>word.length===this.state.wordLength); this.state.wordDatabase = filtered.map(word=>word.toUpperCase()); this.state.normalizedWordDatabase=this.state.wordDatabase.map(word=>this.normalizeString(word)); this.elements.messageDisplay.textContent=''; this.startGame(); } catch(e){ this.elements.messageDisplay.textContent='Erro: '+e.message; console.error(e); } },
            saveGameData: function() { localStorage.setItem('termoGameData',JSON.stringify({victoryCount:this.state.victoryCount,recordCount:this.state.recordCount})); },
            loadGameData: function() { const data = localStorage.getItem('termoGameData'); if(data){ const d=JSON.parse(data); this.state.victoryCount=d.victoryCount; this.state.recordCount=d.recordCount; this.elements.victoryCountDisplay.textContent=this.state.victoryCount; this.elements.recordCountDisplay.textContent=this.state.recordCount; } },
            startGame: function() { this.state.currentWords=[]; this.state.solvedWords=0; const numWords=parseInt(this.elements.wordCountSelect.value); this.state.maxAttempts=numWords+5; const shuffledWords=this.state.wordDatabase.sort(()=>0.5-Math.random()); for(let i=0;i<numWords;i++){ this.state.currentWords.push({word:shuffledWords[i],solved:false}); } this.resetGame(); this.createGameBoards(); this.createKeyboard(); if(document.querySelector('.box')) this.focusBox(document.querySelector('.box')); this.state.startTime=new Date(); },
            resetGame: function() { this.elements.gameContainer.innerHTML=''; this.elements.messageDisplay.textContent=''; this.state.currentRow=0; this.state.activeBox=null; this.elements.keyboardContainer.innerHTML=''; this.state.keyColorStates={}; },
            createGameBoards: function() { const numWords=this.state.currentWords.length; this.elements.gameContainer.style.gridTemplateColumns=`repeat(${numWords},1fr)`; this.state.currentWords.forEach((wordObj,wordIndex)=>{ const gameBoardDiv=document.createElement('div'); gameBoardDiv.classList.add('gameBoard'); gameBoardDiv.id=`gameBoard-${wordIndex}`; for(let i=0;i<this.state.maxAttempts;i++){ const row=document.createElement('div'); row.classList.add('row'); for(let j=0;j<this.state.wordLength;j++){ const box=document.createElement('div'); box.classList.add('box'); box.dataset.row=i; box.dataset.col=j; box.dataset.wordIndex=wordIndex; box.tabIndex=0; box.addEventListener('click',()=>this.focusBox(box)); row.appendChild(box); } gameBoardDiv.appendChild(row); } this.elements.gameContainer.appendChild(gameBoardDiv); }); },
            focusBox: function(box) { if(box.dataset.row!=this.state.currentRow) return; if(this.state.activeBox) this.state.activeBox.classList.remove('active'); this.state.activeBox=box; this.state.activeBox.classList.add('active'); },
            createKeyboard: function() { const keys=['Q','W','E','R','T','Y','U','I','O','P','A','S','D','F','G','H','J','K','L','ENTER','Z','X','C','V','B','N','M','DEL']; this.elements.keyboardContainer.innerHTML=''; const numWords=parseInt(this.elements.wordCountSelect.value); const keyboardRows=[keys.slice(0,10),keys.slice(10,19),keys.slice(19)]; keyboardRows.forEach(rowKeys=>{ const rowDiv=document.createElement('div'); rowDiv.classList.add('key-row'); rowKeys.forEach(keyText=>{ const key=document.createElement('div'); key.classList.add('key'); if(keyText==='ENTER'||keyText==='DEL') key.classList.add('wide-key'); key.dataset.key=keyText.toLowerCase(); key.addEventListener('click',()=>this.handleKeyClick(keyText)); rowDiv.appendChild(key); }); this.elements.keyboardContainer.appendChild(rowDiv); }); },
            handleKeyClick: function(keyText) { if(keyText==='ENTER'){ this.checkAllWords(); } else if(keyText==='DEL'){ this.deleteLetter(); } else if(keyText.length===1){ this.addLetter(keyText); } },
            addLetter: function(letter) { if(this.state.activeBox){ if(this.state.activeBox.dataset.row!=this.state.currentRow) return; this.state.activeBox.textContent=letter; const currentCol=parseInt(this.state.activeBox.dataset.col); const nextCol=currentCol+1; if(nextCol<this.state.wordLength){ const wordIndex=parseInt(this.state.activeBox.dataset.wordIndex); const gameBoardDiv=document.getElementById(`gameBoard-${wordIndex}`); const nextBox=gameBoardDiv.children[this.state.currentRow].children[nextCol]; this.focusBox(nextBox); } } },
            deleteLetter: function(){ if(!this.state.activeBox) return; this.state.activeBox.textContent=''; },
            checkAllWords: function(){ this.state.currentWords.forEach((w,i)=>{ if(!w.solved)this.checkWord(i); }); },
            checkWord: function(wordIndex){ const board=document.getElementById(`gameBoard-${wordIndex}`); const row=board.children[this.state.currentRow]; let guessedWord=''; Array.from(row.children).forEach(box=>guessedWord+=box.textContent.toUpperCase()); if(guessedWord.length!==this.state.wordLength){ this.showTemporaryMessage('Preencha todas as letras!'); return; } const normalizedGuessed=this.normalizeString(guessedWord); const correctWord=this.state.currentWords[wordIndex].word.toUpperCase(); const normalizedCorrect=this.normalizeString(correctWord); if(normalizedGuessed===normalizedCorrect){ Array.from(row.children).forEach((box,i)=>{ box.textContent=correctWord[i]; box.classList.add('correct'); }); this.state.currentWords[wordIndex].solved=true; this.state.solvedWords++; Array.from(board.children).forEach(r=>Array.from(r.children).forEach(box=>box.removeEventListener('click',()=>this.focusBox(box)))); this.playSound(this.sounds.correct); } else{ Array.from(row.children).forEach((box,i)=>{ const letter=guessedWord[i]; if(letter===correctWord[i]) box.classList.add('correct'); else if(correctWord.includes(letter)) box.classList.add('present'); else box.classList.add('absent'); }); this.playSound(this.sounds.incorrect); } if(this.state.solvedWords===this.state.currentWords.length){ this.showEndGameModal('Voc√™ venceu!', new Date()-this.state.startTime,true); this.disableGame(); } else if(this.state.currentRow>=this.state.maxAttempts-1){ this.showEndGameModal('Voc√™ perdeu!', new Date()-this.state.startTime,false); this.disableGame(); this.state.victoryCount=0; this.elements.victoryCountDisplay.textContent=this.state.victoryCount; this.saveGameData(); } else{ this.state.currentRow++; this.state.activeBox=null; const firstBox=document.querySelector(`.box[data-row="${this.state.currentRow}"]`); if(firstBox)this.focusBox(firstBox); } },
            showEndGameModal:function(msg,time,isWin){ this.elements.modalStatus.textContent=msg; if(isWin)this.elements.modalCorrectWords.textContent='Parab√©ns! Voc√™ concluiu o desafio.'; else this.elements.modalCorrectWords.textContent='As palavras eram: '+this.state.currentWords.map(w=>w.word).join(', '); this.elements.modalVictories.textContent=this.state.victoryCount; this.elements.modalRecord.textContent=this.state.recordCount; const seconds=Math.floor(time/1000); const minutes=Math.floor(seconds/60); const remainingSeconds=seconds%60; this.elements.modalTime.textContent=`${minutes}min ${remainingSeconds}s`; this.elements.endGameModal.style.display='flex'; },
            disableGame:function(){ document.querySelectorAll('.key').forEach(k=>k.replaceWith(k.cloneNode(true))); if(this.state.activeBox)this.state.activeBox.classList.remove('active'); },
            focusBox:function(box){ if(box.dataset.row!=this.state.currentRow) return; if(this.state.activeBox)this.state.activeBox.classList.remove('active'); this.state.activeBox=box; this.state.activeBox.classList.add('active'); },
            toggleMute:function(){ this.state.isMuted=!this.state.isMuted; this.elements.muteButton.textContent=this.state.isMuted?'üîá':'üîä'; },
            showHintModal:function(){ this.elements.hintModal.style.display='flex'; },
            revealHint:function(){ this.elements.hintModal.style.display='none'; if(!this.state.activeBox) return; const activeWordIndex=parseInt(this.state.activeBox.dataset.wordIndex); const activeWord=this.state.currentWords[activeWordIndex].word; const activeRow=document.getElementById(`gameBoard-${activeWordIndex}`).children[this.state.currentRow]; const availableLetters=[]; for(let i=0;i<this.state.wordLength;i++){ const box=activeRow.children[i]; if(!box.textContent) availableLetters.push({letter:activeWord[i],index:i}); } if(availableLetters.length>0){ const randomHint=availableLetters[Math.floor(Math.random()*availableLetters.length)]; const boxToFill=activeRow.children[randomHint.index]; boxToFill.textContent=randomHint.letter; boxToFill.classList.add('correct'); } },
            handleKeyDown:function(e){ const key=e.key.toUpperCase(); if(key==='ENTER'){ this.checkAllWords(); } else if(key==='BACKSPACE'){ if(this.state.activeBox){ this.state.activeBox.textContent=''; const col=parseInt(this.state.activeBox.dataset.col); if(col>0){ const wordIndex=parseInt(this.state.activeBox.dataset.wordIndex); const gameBoard=document.getElementById(`gameBoard-${wordIndex}`); this.focusBox(gameBoard.children[this.state.currentRow].children[col-1]); } } } else if(key.match(/^[A-Z]$/)){ this.addLetter(key); } }
        };
        document.addEventListener('DOMContentLoaded',()=>{ TermoGame.init(); });
    </script>
</body>
</html>
